{% extends "base.html" %}
{% load static %}

{% block title %}Samples{% endblock %}

{% block head_extras %}
    <link href="{% static 'css/bootstrap_table_cus2.css' %}" rel="stylesheet">
{% endblock %}

{% block content %}

    <!-- mapping of DetailView with url prefix without pk argument -->
    {{ url_prefix_dict |json_script:"url_prefix_dict" }}

<div>
    <h4>List of Samples</h4>
    <br>
    <div id="toolbar">
        <!-- add download button with dropdown menu to the toolbar -->
        <button class="btn btn-primary dropdown-toggle"  href="#", id="dropdown-download-data", type="button" data-bs-toggle="dropdown",
                title="Download all data" aria-haspopup="true" aria-expanded="false"><i class="fa fa-download"></i></button>
            <div class="dropdown-menu" aria-labelledby="dropdown-download-data">
                <a class="dropdown-item" href="{% static 'summary/sample_list_summary.csv' %}">All Data in CSV</a>
                <a class="dropdown-item" href="{% static 'summary/sample_list_summary.tsv' %}">All Data in TSV</a>
                <a class="dropdown-item" href="{% static 'summary/sample_list_summary.xlsx' %}">All Data in EXCEL</a>
            </div>
        </button>
    </div>
    <table
        id="sample_table"
        data-toggle="table"
        data-toolbar="#toolbar"
        data-buttons-class="primary"
        data-buttons-align="left"
        data-search="true"
        data-search-align="left"
        data-show-search-clear-button="true"
        data-show-multi-sort="true"
        data-show-columns="true"
        data-show-columns-toggle-all="true"
        data-show-fullscreen="true"
        data-show-extended-pagination="true"
        data-pagination="true"
        data-side-pagination="server"
        data-page-list="[10, 25, 50, 100, 200, 500]"
        data-url="{% url 'sample_json_data' %}">
        <thead>
            <tr>
                <th data-field="sample" data-formatter="sampleNameFormatter" data-sortable="true">{{col_mapping_dict.sample }}</th>
                <th data-field="animal" data-formatter="animalNameFormatter" data-sortable="true">{{col_mapping_dict.animal }}</th>
                <th data-field="tissue" data-formatter="tissueNameFormatter" data-sortable="true">{{col_mapping_dict.tissue }}</th>
                <th data-field="studies" data-formatter="studyListFormatter">{{ col_mapping_dict.studies }}</th>
                <th data-field="genotype" data-sortable="true">{{ col_mapping_dict.genotype }}</th>
                <th data-field="infusate_name" data-formatter="infusateNameFormatter" data-sortable="true">{{ col_mapping_dict.infusate_name }}</th>
                <th data-field="tracers" data-formatter="tracerListFormatter" data-sortable="true">{{ col_mapping_dict.tracers }}</th>
                <th data-field="concentrations" data-sortable="true">{{ col_mapping_dict.concentrations }}</th>
                <th data-field="labeled_elements" data-sortable="true">{{ col_mapping_dict.labeled_elements }}</th>
                <th data-field="infusion_rate" data-visible="false">{{ col_mapping_dict.infusion_rate }}</th>
                <th data-field="treatment" data-formatter="treatmentFormatter" data-sortable="true">{{ col_mapping_dict.treatment }}</th>
                <th data-field="body_weight" data-visible="false">{{ col_mapping_dict.body_weight }}</th>
                <th data-field="age_in_weeks" data-sortable="true">{{ col_mapping_dict.age_in_weeks }}</th>
                <th data-field="sex" data-visible="false">{{ col_mapping_dict.sex }}</th>
                <th data-field="diet" data-visible="false">{{ col_mapping_dict.diet }}</th>
                <th data-field="feeding_status">{{ col_mapping_dict.feeding_status }}</th>
                <th data-field="sample_owner">{{ col_mapping_dict.sample_owner }}</th>
                <th data-field="sample_date_formatted" data-sortable="true">{{ col_mapping_dict.sample_date_formatted }}</th>
                <th data-field="sample_time_collected_m" data-sortable="true">{{ col_mapping_dict.sample_time_collected_m }}</th>
                <th data-field="msrunsample_owner" data-sortable="true">{{ col_mapping_dict.msrunsample_owner }}</th>
                <th data-field="msrunsample_date_formatted" data-sortable="true">{{ col_mapping_dict.msrunsample_date_formatted }}</th>
                <th data-field="msrunsample_id" data-formatter="msrunFormatter">MSrun Detail</th>
            </tr>
        </thead>
    </table>
</div>

{% endblock %}

{% block js_extras %}
    <!-- functions for formatting column values -->
    <script src="{% static 'js/summary_table_column_formatters.js' %}"></script>
    <script>
        $('#sample_table').bootstrapTable({
            undefinedText: 'None'
        })
    </script>
{% endblock %}
