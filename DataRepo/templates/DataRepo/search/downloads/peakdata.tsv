{% load customtags %}Sample	Tissue	Peak Group	Measured Compound(s)	Measured Compound Synonym(s)	Formula	Labeled Element:Count	Raw Abundance	Corrected Abundance	Fraction	Median M/Z	Median RT	Peak Group Set Filename	Animal	Genotype	Body Weight (g)	Age (weeks)	Sex	Diet	Feeding Status	Treatment	Tracer Compound	Tracer Infusion Rate (ul/min/g)	Tracer Infusion Concentration (mM)	Study
{% for pd in res.all %}{% createDict as mm_lookup %}{% createDict as keeping %}{% for study in pd.peak_group.msrun.sample.animal.studies.all %}{% addToDict mm_lookup "peak_group__msrun__sample__animal__studies" study %}{% addToDict keeping "keep" False %}{% for cs in pd.peak_group.compounds.all %}{% addToDict mm_lookup "peak_group__compounds" cs %}{% for ss in cs.synonyms.all %}{% addToDict mm_lookup "peak_group__compounds__synonyms" ss %}{% if not keeping.keep %}{% shouldKeepManyToMany pd mm_lookup qry refilter as keep %}{% addToDict keeping "keep" keep %}{% endif %}{% endfor %}{% endfor %}{% if keeping.keep %}{{ pd.peak_group.msrun.sample.name }}	{{ pd.peak_group.msrun.sample.tissue.name }}	{{ pd.peak_group.name }}	{% define True as cpdfirst %}{% for mcpd in pd.peak_group.compounds.all %}{% if not cpdfirst %};{% endif%}{{ mcpd.name }}{% define False as cpdfirst %}{% endfor %}	{% define True as cpdfirst %}{% for mcpd in pd.peak_group.compounds.all %}{% if not cpdfirst %};{% endif%}{% define True as synfirst %}{% get_case_insensitive_synonyms mcpd.synonyms as inssyns %}{% for mcpdsyn in inssyns %}{% if not synfirst %}/{% endif%}{{ mcpdsyn }}{% define False as synfirst %}{% endfor %}{% define False as cpdfirst %}{% endfor %}	{{ pd.peak_group.formula }}	{{ pd.labeled_element }}:{{ pd.labeled_count }}	{{ pd.raw_abundance }}	{{ pd.corrected_abundance }}	{{ pd.fraction }}	{{ pd.med_mz }}	{{ pd.med_rt }}	{{ pd.peak_group.peak_group_set.filename }}	{{ pd.peak_group.msrun.sample.animal.name }}	{{ pd.peak_group.msrun.sample.animal.genotype }}	{{ pd.peak_group.msrun.sample.animal.body_weight }}	{{ pd.peak_group.msrun.sample.animal.age|durationToWeeks }}	{{ pd.peak_group.msrun.sample.animal.sex }}	{{ pd.peak_group.msrun.sample.animal.diet }}	{{ pd.peak_group.msrun.sample.animal.feeding_status }}	{{ pd.peak_group.msrun.treatment.name }}	{% if pd.peak_group.msrun.sample.animal.tracer_compound is None %}None{% else %}{{ pd.peak_group.msrun.sample.animal.tracer_compound.name }}{% endif %}	{{ pd.peak_group.msrun.sample.animal.tracer_infusion_rate }}	{{ pd.peak_group.msrun.sample.animal.tracer_infusion_concentration }}	{{ study.name }}
{% endif %}{% endfor %}{% endfor %}
